// Generated by CoffeeScript 1.12.7
(function() {
  jQuery(document).ready(function() {
    var currentGame, processData, puzzleGame, reqParam, retrieveResources;
    puzzleGame = (function() {
      function puzzleGame(debug, xsplit, ysplit, answers) {
        this.debug = debug;
        this.xsplit = xsplit;
        this.ysplit = ysplit;
        this.answers = answers;
      }

      puzzleGame.prototype.init = function(resources) {
        var col, i, imgHeight, imgWidth, primImg, row, tile, tileHeight, tileWidth, tiles;
        this.resources = resources;
        primImg = $('#defaultImg');
        $(primImg).css('background-image', 'url(' + this.resources[0]['High resolution image'] + ')');
        tiles = this.xsplit * this.ysplit;
        imgWidth = primImg.width();
        imgHeight = primImg.height();
        tileWidth = imgWidth / this.xsplit;
        tileHeight = imgHeight / this.ysplit;
        i = 0;
        col = 0;
        while (col < this.ysplit) {
          row = 0;
          while (row < this.xsplit) {
            tile = $(primImg.clone());
            tile.draggable();
            tile.addClass('tile');
            tile.removeAttr('id', '');
            tile.css({
              'background-image': primImg.css('background-image'),
              'background-position': -row * tileWidth + 'px ' + -col * tileHeight + 'px',
              'width': tileWidth,
              'height': tileHeight
            });
            tile;
            $('#gameArea').append(tile);
            i++;
            row++;
            if (this.debug) {
              console.log('created', i, 'tile at', row, col);
            }
          }
          col++;
        }
        primImg.hide();
        if (this.debug) {
          console.log('current selector', primImg, '--- Width', imgWidth, 'Height', imgHeight, 'TileWidth', tileWidth, 'TileHight', tileHeight);
          return console.log('solution', this.resources[0]);
        }
      };

      puzzleGame.prototype.reset = function() {
        console.log(this.resources);
        return console.log('abstract reset method');
      };

      return puzzleGame;

    })();
    currentGame = new puzzleGame(true, 4, 4, 8);
    reqParam = {
      resource_id: 'cf6e12d8-bd8d-4232-9843-7fa3195cee1c',
      limit: 10
    };
    retrieveResources = function() {
      return $.ajax({
        url: 'https://data.gov.au/api/action/datastore_search',
        data: reqParam,
        dataType: 'jsonp',
        cache: true
      });
    };
    processData = function(data) {
      var item, j, len, processedData, ref;
      processedData = [];
      ref = data.result.records;
      for (j = 0, len = ref.length; j < len; j++) {
        item = ref[j];
        if (item['High resolution image']) {
          processedData.push(item);
        }
      }
      return processedData;
    };
    $('#play').click(function() {
      retrieveResources().then(function(res) {
        currentGame.init(processData(res));
      });
    });
    $('#reset').click(function() {
      currentGame.reset();
    });
  });

}).call(this);
